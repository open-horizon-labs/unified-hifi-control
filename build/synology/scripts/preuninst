#!/bin/bash

PACKAGE_NAME="unified-hifi-control"

# Use Synology environment variables for paths
if [ -n "${SYNOPKG_PKGVAR}" ]; then
    PKGVAR="${SYNOPKG_PKGVAR}"
else
    PKGVAR="/var/packages/${PACKAGE_NAME}/var"
fi

PID_FILE="${PKGVAR}/${PACKAGE_NAME}.pid"

# Stop the service if running
if [ -f "$PID_FILE" ]; then
    PID=$(cat "$PID_FILE")
    if kill -0 "$PID" 2>/dev/null; then
        kill "$PID"
        sleep 2
        kill -9 "$PID" 2>/dev/null
    fi
    rm -f "$PID_FILE"
fi

exit 0
